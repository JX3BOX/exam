(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0156ce5a"],{3506:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"c-take-question"},[t.currentQuestion?s("div",{staticClass:"c-take-question-content"},[s("h3",{staticClass:"q-text"},[void 0!==t.isCorrect?s("i",{class:{"el-icon-success":!0===t.isCorrect,"el-icon-error":!1===t.isCorrect}}):t._e(),s("Article",{attrs:{content:t.currentQuestion.title}})],1),s("div",{staticClass:"q-attr"},[s("span",{staticClass:"q-attr-hint"},[t._v(t._s(t.isMultiple?"多选题":"单选题"))]),s("el-rate",{attrs:{disabled:"","text-color":"#ff9900","score-template":"{value}"},model:{value:t.currentQuestion.hardStar,callback:function(e){t.$set(t.currentQuestion,"hardStar",e)},expression:"currentQuestion.hardStar"}}),s("span",{staticClass:"q-attr-author"},[t._v(" 提交人： "),s("el-link",{attrs:{href:t.paperAuthorLink,target:"_blank",underline:!1}},[s("el-avatar",{attrs:{src:t.paperAuthorAvatar}}),t._v(" "+t._s(t.currentQuestion.createUser)+" ")],1)],1),s("span",{staticClass:"q-attr-author"},[t._v(" 试卷标签： "),s("span",{staticClass:"c-exam-attr-value"},t._l(JSON.parse(t.currentQuestion.tags),(function(e){return s("el-tag",{key:e,attrs:{size:"medium"}},[t._v(t._s(e))])})),1)])],1),t.isMultiple?[s("el-checkbox-group",{model:{value:t.chosenOptions,callback:function(e){t.chosenOptions=e},expression:"chosenOptions"}},t._l(JSON.parse(t.currentQuestion.options),(function(e,n){return s("el-checkbox",{key:n,class:{"is-correct-answer":t.isCorrectAnswerClass(n),"is-wrong-answer":t.isWrongAnswerClass(n)},attrs:{label:n,border:"",disabled:t.isSubmitted}},[t._v(" "+t._s(String.fromCharCode(65+n))+". "),s("Article",{attrs:{content:e}})],1)})),1)]:[s("el-radio-group",{model:{value:t.chosenOptions,callback:function(e){t.chosenOptions=e},expression:"chosenOptions"}},t._l(JSON.parse(t.currentQuestion.options),(function(e,n){return s("el-radio",{key:n,class:{"is-correct-answer":t.isCorrectAnswerClass(n),"is-wrong-answer":t.isWrongAnswerClass(n)},attrs:{label:n,border:"",disabled:t.isSubmitted}},[t._v(" "+t._s(String.fromCharCode(65+n))+". "),s("Article",{attrs:{content:e}})],1)})),1)],s("div",{staticClass:"c-exam-take-btn"},[t.isSubmitted||t.loading||!t.currentQuestion?t._e():s("el-button",{attrs:{type:"success",disabled:null===t.chosenOptions||""===JSON.stringify(t.chosenOptions)||"[]"===JSON.stringify(t.chosenOptions)},on:{click:t.preSubmitQuestion}},[t._v("提交")])],1),t.questionAnswer?s("div",{staticClass:"q-whyami"},[s("h3",[t._v("解析")]),s("div",{staticClass:"q-whyami-content",domProps:{innerHTML:t._s(t.questionAnswer.whyami)}})]):t._e(),t.isAdmin?s("div",{staticClass:"m-exam-op"},[s("el-button",{attrs:{type:"warning",plain:"",size:"small",icon:"el-icon-circle-close"},on:{click:function(e){return t.check("restore")}}},[t._v("复审")]),s("el-button",{attrs:{type:"danger",plain:"",size:"small",icon:"el-icon-delete"},on:{click:function(e){return t.check("delete")}}},[t._v("删除")])],1):t._e()],2):t._e(),s("div",{staticClass:"m-exam-comment"},[s("el-divider",{attrs:{"content-position":"left"}},[s("i",{staticClass:"el-icon-chat-line-square"}),t._v(" 讨论")]),s("Comment",{attrs:{id:t.id,category:"question"}})],1)])},i=[],r=(s("99af"),s("caad"),s("d81d"),s("b0c0"),s("ac1f"),s("2532"),s("5319"),s("408b")),o=s("64c7"),a=s("ee8f"),c=s("a974"),u=s("85e4"),l=s("e494"),h=s("23d8"),d=s("6f05"),p={name:"TakeQuestion",components:{Article:c["a"],Comment:h["a"]},data:function(){return{loading:!1,chosenOptions:null,currentQuestion:null,questionid:null,showAnswer:!1,isSubmitted:!1,questionAnswer:null,correctAnswer:null,isCorrect:void 0,authorAvatarUrl:"",isAdmin:a["User"].getInfo().group>60}},computed:{isMultiple:function(){return"checkbox"===this.currentQuestion.type},paperAuthorAvatar:function(){return Object(u["showAvatar"])(this.authorAvatarUrl,"s")},paperAuthorLink:function(){return Object(u["authorLink"])(this.currentQuestion.createUserId)},id:function(){return this.$route.params.id}},mounted:function(){"localhost"!=location.hostname&&this.checkLogin(),"question-take"==this.$route.name&&Object(l["a"])("question",this.$route.params.id)},methods:{checkLogin:function(){a["User"].isLogin()?this.getQuestionId():(this.$message.error("请先登录"),a["User"].destroy(),setTimeout((function(){a["User"].toLogin()}),1e3))},getAuthorAvatar:function(t){var e=this;Object(r["a"])("https://server.jx3box.com/user/info?uid=".concat(t),"GET").then((function(t){10024===t.code&&(e.authorAvatarUrl=t.data.avatar)})).catch((function(t){console.log(t)}))},getQuestionId:function(){var t=this;if(!this.$route.params.id)return this.$message.error("题目不存在！"),setTimeout((function(){t.$router.go("-1")}),1e3),!1;this.questionid=this.$route.params.id,this.getQuestion()},getQuestion:function(){var t=this;if(this.loading=!0,!this.$route.params.questionInfo)return this.$message.error("进入方法非法！请从试题列表页重新进入"),setTimeout((function(){t.$router.replace("/qlist")}),1e3),!1;this.currentQuestion=this.$route.params.questionInfo,"checkbox"===this.currentQuestion.type?this.chosenOptions=[]:this.chosenOptions=null,this.loading=!1,this.getAuthorAvatar(this.currentQuestion.createUserId)},preSubmitQuestion:function(){var t=[],e=this.chosenOptions,s=JSON.parse(this.currentQuestion.options);if(null===e)return!1;if("number"!==typeof e){if(0===e.length)return!1;t=e.map((function(t){return s[t]}))}else t=[s[e]];this.submitQuestion(t)},submitQuestion:function(t){var e=this,s=Object(r["b"])(o["__next"],"api/question/user-exam-paper/q/".concat(this.questionid,"/answer"));this.isSubmitted=!0,this.loading=!0,Object(r["a"])(s,"POST",!0,t).then((function(t){e.questionAnswer=t.question,e.correctAnswer=t.question.answerList,e.isCorrect=t.right})).catch((function(t){switch(e.isSubmitted=!1,t.code){case-1:e.$message.error(t.msg);break;case 9999:e.$message.error("登录失效, 请重新登录"),a["User"].destroy(),setTimeout((function(){a["User"].toLogin()}),1e3);break;default:e.$message.error("[".concat(t.code,"]").concat(t.msg))}})).then((function(){e.loading=!1}))},isCorrectAnswerClass:function(t){return!!this.correctAnswer&&this.correctAnswer.includes(t)},isWrongAnswerClass:function(t){if(this.correctAnswer&&!this.correctAnswer.includes(t)&&null!==this.chosenOptions){if(this.chosenOptions===t)return!0;if("number"!==typeof this.chosenOptions)return this.chosenOptions.includes(t)}return!1},check:function(t){var e=this;"delete"==t?this.$alert("确定删除吗","消息",{confirmButtonText:"确定",callback:function(s){"confirm"==s&&Object(d["b"])(e.id,t).then((function(t){e.$message({message:t.data.msg||"操作成功",type:"success"}),location.reload()}))}}):Object(d["b"])(this.id,t).then((function(t){e.$message({message:t.data.msg||"操作成功",type:"success"}),location.reload()}))}}},m=p,f=(s("902d"),s("2877")),b=Object(f["a"])(m,n,i,!1,null,null,null);e["default"]=b.exports},"6f05":function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"a",(function(){return c}));var n=s("bc3a"),i=s.n(n),r=s("64c7"),o=(i.a.create({baseURL:r["__server"],withCredentials:!0}),r["__next"]+"api/question/");function a(t,e){return i.a.put(o+t+"/check","",{params:{action:e},withCredentials:!0})}function c(t,e){return i.a.put(o+"exam-paper/"+t+"/opt","",{params:{action:e},withCredentials:!0})}},"902d":function(t,e,s){"use strict";s("bcb1")},bcb1:function(t,e,s){},d81d:function(t,e,s){"use strict";var n=s("23e7"),i=s("b727").map,r=s("1dde"),o=s("ae40"),a=r("map"),c=o("map");n({target:"Array",proto:!0,forced:!a||!c},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},e494:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var n=s("bc3a"),i=s.n(n),r=s("64c7");r["__next"];var o=r["__next"]+"api/summary-any/";function a(t,e){return i.a.get(o+t+"-"+e,{params:{type:t,actions:"views"}})}r["__next"]}}]);
//# sourceMappingURL=chunk-0156ce5a.fcd9cf55.js.map