(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-328250fd"],{"0cb2":function(t,e,n){var r=n("7b0b"),s=Math.floor,i="".replace,o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,c,u,l){var d=n+t.length,h=c.length,f=a;return void 0!==u&&(u=r(u),f=o),i.call(l,f,(function(r,i){var o;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(d);case"<":o=u[i.slice(1,-1)];break;default:var a=+i;if(0===a)return r;if(a>h){var l=s(a/10);return 0===l?r:l<=h?void 0===c[l-1]?i.charAt(1):c[l-1]+i.charAt(1):r}o=c[a-1]}return void 0===o?"":o}))}},2300:function(t,e,n){"use strict";n("4ef9")},2777:function(t,e,n){"use strict";var r=n("bc3a"),s=n.n(r);n.d(e,"a",(function(){return s.a}));var i=n("65c2");s.a.create({baseURL:i["__server"],withCredentials:!0}),s.a.create({withCredentials:!0,baseURL:i["__next"]})},3506:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"c-take-question"},[t.currentQuestion?n("div",{staticClass:"c-take-question-content"},[n("div",{staticClass:"q-text-title"},[n("h3",{staticClass:"q-text"},[void 0!==t.isCorrect?n("i",{class:{"el-icon-success":!0===t.isCorrect,"el-icon-error":!1===t.isCorrect}}):t._e(),n("Article",{attrs:{content:t.currentQuestion.title}})],1),n("div",{staticClass:"m-exam-op"},[n("Fav",{staticStyle:{"padding-top":"9px","padding-bottom":"9px"},attrs:{"post-type":"question","post-id":t.id}}),t.isAuthor?n("el-button",{attrs:{type:"primary",plain:"",size:"small",icon:"el-icon-edit-outline"},on:{click:t.edit}},[t._v("编辑")]):t._e(),t.isAdmin?n("el-button",{attrs:{type:"danger",plain:"",size:"small",icon:"el-icon-delete"},on:{click:function(e){return t.check("delete")}}},[t._v("删除")]):t._e()],1)]),n("div",{staticClass:"q-attr"},[n("span",{staticClass:"q-attr-hint"},[t._v(t._s(t.isMultiple?"多选题":"单选题"))]),n("el-rate",{attrs:{disabled:"","text-color":"#ff9900","score-template":"{value}"},model:{value:t.currentQuestion.hardStar,callback:function(e){t.$set(t.currentQuestion,"hardStar",e)},expression:"currentQuestion.hardStar"}}),n("span",{staticClass:"q-attr-author"},[t._v(" 提交人： "),n("el-link",{attrs:{href:t.paperAuthorLink,target:"_blank",underline:!1}},[t._v(" "+t._s(t.currentQuestion.createUser)+" ")])],1),n("span",{staticClass:"q-attr-author"},[t._v(" 试卷标签： "),n("span",{staticClass:"c-exam-attr-value"},t._l(JSON.parse(t.currentQuestion.tags),(function(e){return n("el-tag",{key:e,attrs:{size:"medium"}},[t._v(t._s(e))])})),1)])],1),t.isMultiple?[n("el-checkbox-group",{model:{value:t.chosenOptions,callback:function(e){t.chosenOptions=e},expression:"chosenOptions"}},t._l(JSON.parse(t.currentQuestion.options),(function(e,r){return n("el-checkbox",{key:r,class:{"is-correct-answer":t.isCorrectAnswerClass(r),"is-wrong-answer":t.isWrongAnswerClass(r)},attrs:{label:r,border:"",disabled:t.isSubmitted}},[t._v(" "+t._s(String.fromCharCode(65+r))+". "),n("Article",{attrs:{content:e}})],1)})),1)]:[n("el-radio-group",{model:{value:t.chosenOptions,callback:function(e){t.chosenOptions=e},expression:"chosenOptions"}},t._l(JSON.parse(t.currentQuestion.options),(function(e,r){return n("el-radio",{key:r,class:{"is-correct-answer":t.isCorrectAnswerClass(r),"is-wrong-answer":t.isWrongAnswerClass(r)},attrs:{label:r,border:"",disabled:t.isSubmitted}},[t._v(" "+t._s(String.fromCharCode(65+r))+". "),n("Article",{attrs:{content:e}})],1)})),1)],n("div",{staticClass:"c-exam-take-btn"},[t.isSubmitted||t.loading||!t.currentQuestion?t._e():n("el-button",{attrs:{type:"success",disabled:null===t.chosenOptions||""===JSON.stringify(t.chosenOptions)||"[]"===JSON.stringify(t.chosenOptions)},on:{click:t.checkLogin}},[t._v("提交")])],1),t.questionAnswer?n("div",{staticClass:"q-whyami"},[n("h3",[t._v("解析")]),n("div",{staticClass:"q-whyami-content",domProps:{innerHTML:t._s(t.questionAnswer.whyami)}})]):t._e()],2):t._e(),n("div",{staticClass:"m-exam-comment"},[n("el-divider",{attrs:{"content-position":"left"}},[n("i",{staticClass:"el-icon-chat-line-square"}),t._v(" 讨论 ")]),n("Comment",{attrs:{id:t.id,category:"question"}})],1)])},s=[],i=n("1da1"),o=(n("96cf"),n("b0c0"),n("d3b7"),n("ac1f"),n("5319"),n("d81d"),n("99af"),n("caad"),n("2532"),n("408b")),a=n("65c2"),c=(n("ee8f"),n("c9d2")),u=n("a974"),l=n("85e4"),d=n("bc3a"),h=n.n(d);a["__next"];var f=a["__next"]+"api/summary-any/";function p(t,e){return h.a.get(f+t+"-"+e,{params:{type:t,actions:"views"}})}a["__next"];var m=n("23d8"),v=n("6f05"),g={name:"TakeQuestion",components:{Article:u["a"],Comment:m["a"]},data:function(){return{loading:!1,chosenOptions:null,currentQuestion:null,questionid:null,showAnswer:!1,isSubmitted:!1,questionAnswer:null,correctAnswer:null,isCorrect:void 0,authorAvatarUrl:"",isAdmin:c["a"].isEditor()}},computed:{isMultiple:function(){return"checkbox"===this.currentQuestion.type},paperAuthorAvatar:function(){return Object(l["showAvatar"])(this.authorAvatarUrl,"s")},paperAuthorLink:function(){return Object(l["authorLink"])(this.currentQuestion.createUserId)},id:function(){return this.$route.params.id},author_id:function(){return this.currentQuestion.createUserId},isAuthor:function(){return c["a"].isLogin()&&c["a"].getInfo().uid==this.author_id}},mounted:function(){"question-take"==this.$route.name&&p("question",this.$route.params.id),this.getQuestionId()},methods:{checkLogin:function(){if("localhost"!=location.hostname&&!c["a"].isLogin())return this.$message.error("请先登录"),c["a"].destroy(),setTimeout((function(){c["a"].toLogin()}),1e3),!1;this.preSubmitQuestion()},getAuthorAvatar:function(t){var e=this;Object(o["a"])("https://server.jx3box.com/user/info?uid=".concat(t),"GET").then((function(t){10024===t.code&&(e.authorAvatarUrl=t.data.avatar)})).catch((function(t){console.log(t)}))},getQuestionId:function(){var t=this;if(!this.$route.params.id)return this.$message.error("题目不存在！"),setTimeout((function(){t.$router.go("-1")}),1e3),!1;this.questionid=this.$route.params.id,this.getQuestion()},getRemoteQuestionInfo:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(o["b"])(a["__next"],"api/question/".concat(t.questionid,"/no-answer")),e.next=3,Object(o["a"])(n,"GET",!0).then((function(e){return e.id?Promise.resolve(e):(t.$message.error("题目不存在！"),setTimeout((function(){t.$router.go("-1")}),1e3),!1)})).catch((function(t){return console.log(t),Promise.reject(t)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},getQuestion:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.loading=!0,console.log(t.$route),!t.$route.params.questionInfo){e.next=6;break}t.currentQuestion=t.$route.params.questionInfo,e.next=16;break;case 6:return e.prev=6,e.next=9,t.getRemoteQuestionInfo();case 9:t.currentQuestion=e.sent,e.next=16;break;case 12:return e.prev=12,e.t0=e["catch"](6),e.t0.msg&&(t.$message.error("题目不存在！"),setTimeout((function(){t.$router.replace("/qlist")}),1e3)),e.abrupt("return",!1);case 16:"checkbox"===t.currentQuestion.type?t.chosenOptions=[]:t.chosenOptions=null,t.loading=!1,t.getAuthorAvatar(t.currentQuestion.createUserId);case 19:case"end":return e.stop()}}),e,null,[[6,12]])})))()},preSubmitQuestion:function(){var t=[],e=this.chosenOptions,n=JSON.parse(this.currentQuestion.options);if(null===e)return!1;if("number"!==typeof e){if(0===e.length)return!1;t=e.map((function(t){return n[t]}))}else t=[n[e]];this.submitQuestion(t)},submitQuestion:function(t){var e=this,n=Object(o["b"])(a["__next"],"api/question/user-exam-paper/q/".concat(this.questionid,"/answer"));this.isSubmitted=!0,this.loading=!0,Object(o["a"])(n,"POST",!0,t).then((function(t){e.questionAnswer=t.question,e.correctAnswer=t.question.answerList,e.isCorrect=t.right})).catch((function(t){switch(e.isSubmitted=!1,console.log(t),t.code){case-1:e.$message.error(t.msg);break;case 401:e.$message.error(t.msg),c["a"].destroy(),setTimeout((function(){c["a"].toLogin()}),1e3);break;default:e.$message.error("[".concat(t.code,"]").concat(t.msg))}})).then((function(){e.loading=!1}))},isCorrectAnswerClass:function(t){return!!this.correctAnswer&&this.correctAnswer.includes(t)},isWrongAnswerClass:function(t){if(this.correctAnswer&&!this.correctAnswer.includes(t)&&null!==this.chosenOptions){if(this.chosenOptions===t)return!0;if("number"!==typeof this.chosenOptions)return this.chosenOptions.includes(t)}return!1},check:function(t){var e=this;"delete"==t?this.$alert("确定删除吗？","消息",{confirmButtonText:"确定",callback:function(n){"confirm"==n&&Object(v["b"])(e.id,t).then((function(t){e.$message({message:t.data.msg||"操作成功",type:"success"}),location.reload()}))}}):Object(v["b"])(this.id,t).then((function(t){e.$message({message:t.data.msg||"操作成功",type:"success"}),location.reload()}))},edit:function(){location.href=Object(l["publishLink"])("question")+"/"+this.id}}},b=g,_=(n("902d"),n("2300"),n("2877")),w=Object(_["a"])(b,r,s,!1,null,"2497c946",null);e["default"]=w.exports},"4ef9":function(t,e,n){},5319:function(t,e,n){"use strict";var r=n("d784"),s=n("825a"),i=n("50c4"),o=n("a691"),a=n("1d80"),c=n("8aa5"),u=n("0cb2"),l=n("14c3"),d=Math.max,h=Math.min,f=function(t){return void 0===t?t:String(t)};r("replace",2,(function(t,e,n,r){var p=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,m=r.REPLACE_KEEPS_$0,v=p?"$":"$0";return[function(n,r){var s=a(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,s,r):e.call(String(s),n,r)},function(t,r){if(!p&&m||"string"===typeof r&&-1===r.indexOf(v)){var a=n(e,t,this,r);if(a.done)return a.value}var g=s(t),b=String(this),_="function"===typeof r;_||(r=String(r));var w=g.global;if(w){var x=g.unicode;g.lastIndex=0}var k=[];while(1){var A=l(g,b);if(null===A)break;if(k.push(A),!w)break;var C=String(A[0]);""===C&&(g.lastIndex=c(b,i(g.lastIndex),x))}for(var O="",q=0,S=0;S<k.length;S++){A=k[S];for(var $=String(A[0]),Q=d(h(o(A.index),b.length),0),y=[],E=1;E<A.length;E++)y.push(f(A[E]));var L=A.groups;if(_){var j=[$].concat(y,Q,b);void 0!==L&&j.push(L);var I=String(r.apply(void 0,j))}else I=u($,b,Q,y,L,r);Q>=q&&(O+=b.slice(q,Q)+I,q=Q+$.length)}return O+b.slice(q)}]}))},"6f05":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var r=n("2777"),s=n("65c2"),i=s["__next"]+"api/question/";function o(t,e){return r["a"].put(i+t+"/check","",{params:{action:e},withCredentials:!0})}function a(t,e){return r["a"].put(i+"exam-paper/"+t+"/opt","",{params:{action:e},withCredentials:!0})}},"902d":function(t,e,n){"use strict";n("bcb1")},bcb1:function(t,e,n){}}]);
//# sourceMappingURL=chunk-328250fd.adfd5d45.js.map